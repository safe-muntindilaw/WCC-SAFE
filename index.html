<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <link rel="icon" type="image/svg+xml" href="/logo.svg" />
        <meta
            name="viewport"
            content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
        <link rel="manifest" href="/manifest.json" />
        <meta name="mobile-web-app-capable" content="yes" />
        <meta
            name="apple-mobile-web-app-status-bar-style"
            content="black-translucent" />
        <meta name="apple-mobile-web-app-title" content="SAFE" />
        <link rel="apple-touch-icon" href="/logo.svg" />
        <meta name="theme-color" content="#0A3D62" />
        <title>SAFE Muntindilaw</title>

        <style>
            #splash-screen {
                position: fixed;
                inset: 0;
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 9999;
                overflow: hidden;
                transition: opacity 1s ease-in-out;
                cursor: pointer;
                background-color: #0a3d62;
                perspective: 1200px;
            }

            .moving-gradient {
                position: absolute;
                inset: -100%;
                background: radial-gradient(
                    circle at center,
                    rgba(24, 144, 255, 0.3) 0%,
                    rgba(24, 144, 255, 0.1) 45%,
                    rgba(10, 61, 98, 0) 80%
                );
                animation: bgBreath 6s ease-in-out infinite;
                z-index: -1;
                will-change: transform;
            }

            .content {
                text-align: center;
                display: flex;
                flex-direction: column;
                align-items: center;
                z-index: 1;
                position: relative;
                transform-style: preserve-3d;
                will-change: transform;
            }

            .logo-wrapper {
                position: relative;
                display: flex;
                justify-content: center;
                align-items: center;
                animation: logoBreath 6s ease-in-out infinite;
                transform-style: preserve-3d;
            }

            .floating-logo {
                width: 140px;
                position: relative;
                z-index: 2;
                filter: drop-shadow(0 15px 35px rgba(0, 0, 0, 0.4));
                transform: translateZ(60px);
            }

            .logo-ripple {
                position: absolute;
                border: 2px solid rgba(24, 144, 255, 0.4);
                border-radius: 50%;
                z-index: 1;
                animation: rippleExpand 3s cubic-bezier(0.2, 0.4, 0.5, 0.9)
                    infinite;
                transform: translateZ(20px);
            }

            .logo-ripple:nth-child(2) {
                animation-delay: 1.5s;
            }

            @keyframes rippleExpand {
                0% {
                    width: 100px;
                    height: 100px;
                    opacity: 0.8;
                }
                100% {
                    width: 450px;
                    height: 450px;
                    opacity: 0;
                }
            }

            @keyframes bgBreath {
                0%,
                100% {
                    opacity: 0.4;
                    transform: scale(1);
                }
                50% {
                    opacity: 0.8;
                    transform: scale(1.1);
                }
            }

            @keyframes logoBreath {
                0%,
                100% {
                    transform: scale(1);
                }
                50% {
                    transform: scale(1.04);
                }
            }

            .fade-out {
                opacity: 0;
                pointer-events: none;
                transform: scale(1.1);
                transition: opacity 0.8s ease-out, transform 0.8s ease-out;
            }
        </style>

        <script>
            if (sessionStorage.getItem("splashDismissed")) {
                document.write(
                    "<style>#splash-screen { display: none !important; }</style>"
                );
            }
        </script>
    </head>
    <body>
        <div id="splash-screen" onclick="dismissSplash()">
            <div id="bg-glow" class="moving-gradient"></div>
            <div id="logo-container" class="content">
                <div class="logo-wrapper">
                    <div class="logo-ripple"></div>
                    <div class="logo-ripple"></div>
                    <img
                        src="/logo.svg"
                        alt="SAFE Logo"
                        class="floating-logo" />
                </div>
            </div>
        </div>

        <div id="root"></div>
        <div id="notifications"></div>

        <script type="module" src="/src/main.jsx"></script>

        <script>
            function dismissSplash() {
                const splash = document.getElementById("splash-screen");
                splash.classList.add("fade-out");
                sessionStorage.setItem("splashDismissed", "true");
                setTimeout(() => {
                    splash.style.display = "none";
                }, 800);
            }

            const logo = document.getElementById("logo-container");
            const bg = document.getElementById("bg-glow");
            let lastUpdate = 0;

            window.addEventListener("deviceorientation", (event) => {
                const now = Date.now();
                if (now - lastUpdate < 11) return;
                lastUpdate = now;

                const y = event.beta;
                const x = event.gamma;

                if (x !== null && y !== null) {
                    const moveX = Math.max(-35, Math.min(35, x / 1));
                    const moveY = Math.max(-35, Math.min(35, (y - 45) / 1));
                    const rotX = Math.max(-20, Math.min(20, (y - 45) / -2));
                    const rotY = Math.max(-20, Math.min(20, x / 2));

                    requestAnimationFrame(() => {
                        logo.style.transform = `
                            translate3d(${moveX}px, ${moveY}px, 0)
                            rotateX(${rotX}deg)
                            rotateY(${rotY}deg)
                        `;
                        bg.style.transform = `translate3d(${moveX * -1.2}px, ${
                            moveY * -1.2
                        }px, 0) scale(1.2)`;
                    });
                }
            });

            if (
                typeof DeviceOrientationEvent.requestPermission === "function"
            ) {
                document.body.addEventListener(
                    "click",
                    () => {
                        DeviceOrientationEvent.requestPermission().catch(
                            () => {}
                        );
                    },
                    { once: true }
                );
            }
        </script>
    </body>
</html>
