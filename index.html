<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <link rel="icon" type="image/svg+xml" href="/logo.svg" />
        <meta
            name="viewport"
            content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
        <link rel="manifest" href="/manifest.json" />
        <meta name="mobile-web-app-capable" content="yes" />
        <meta
            name="apple-mobile-web-app-status-bar-style"
            content="black-translucent" />
        <meta name="apple-mobile-web-app-title" content="SAFE" />
        <link rel="apple-touch-icon" href="/logo.svg" />
        <meta name="theme-color" content="#0056a0" />
        <title>SAFE Muntindilaw</title>

        <style>
            #splash-screen {
                position: fixed;
                inset: 0;
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 9999;
                overflow: hidden;
                transition: opacity 1s ease-in-out;
                cursor: pointer;
                background-color: #0a3d62;
            }

            .moving-gradient {
                position: absolute;
                inset: -50%; /* Large area for smooth tilt movement */
                background: radial-gradient(
                    circle at center,
                    rgba(24, 144, 255, 0.25) 0%,
                    rgba(24, 144, 255, 0.1) 45%,
                    rgba(10, 61, 98, 0) 80%
                );
                animation: bgBreath 6s ease-in-out infinite;
                z-index: -1;
                will-change: opacity, transform;
            }

            .content {
                text-align: center;
                display: flex;
                flex-direction: column;
                align-items: center;
                z-index: 1;
                position: relative;
                will-change: transform;
            }

            .logo-wrapper {
                position: relative;
                display: flex;
                justify-content: center;
                align-items: center;
                animation: logoBreath 6s ease-in-out infinite;
            }

            .floating-logo {
                width: 140px;
                position: relative;
                z-index: 2;
                filter: drop-shadow(0 0 30px rgba(24, 144, 255, 0.3));
            }

            .logo-ripple {
                position: absolute;
                border: 2px solid rgba(24, 144, 255, 0.4);
                border-radius: 50%; /* Back to perfect circle */
                z-index: 1;
                animation: rippleExpand 3s cubic-bezier(0.2, 0.4, 0.5, 0.9)
                    infinite;
            }

            .logo-ripple:nth-child(2) {
                animation-delay: 1.5s;
            }

            @keyframes rippleExpand {
                0% {
                    width: 100px;
                    height: 100px;
                    opacity: 0.8;
                }
                100% {
                    width: 400px;
                    height: 400px;
                    opacity: 0;
                }
            }

            @keyframes bgBreath {
                0%,
                100% {
                    opacity: 0.4;
                    transform: scale(1);
                }
                50% {
                    opacity: 1;
                    transform: scale(1.15);
                }
            }

            @keyframes logoBreath {
                0%,
                100% {
                    transform: scale(1);
                }
                50% {
                    transform: scale(1.06);
                }
            }

            .fade-out {
                opacity: 0;
                pointer-events: none;
                transform: scale(1.05);
                transition:
                    opacity 0.8s ease-out,
                    transform 0.8s ease-out;
            }
        </style>

        <script>
            if (sessionStorage.getItem("splashDismissed")) {
                document.write(
                    "<style>#splash-screen { display: none !important; }</style>",
                );
            }
        </script>
    </head>
    <body>
        <div id="splash-screen" onclick="dismissSplash()">
            <div id="bg-glow" class="moving-gradient"></div>
            <div id="logo-container" class="content">
                <div class="logo-wrapper">
                    <div class="logo-ripple"></div>
                    <div class="logo-ripple"></div>
                    <img
                        src="/logo.svg"
                        alt="SAFE Logo"
                        class="floating-logo" />
                </div>
            </div>
        </div>

        <div id="root"></div>
        <div id="notifications"></div>

        <script type="module" src="/src/main.jsx"></script>

        <script>
            function dismissSplash() {
                const splash = document.getElementById("splash-screen");

                if ("vibrate" in navigator) {
                    window.navigator.vibrate(10);
                    // console.log("Vibration API unlocked via user gesture");
                }

                // Prime Audio
                const audioUnlock = new Audio("/siren.mp3");
                audioUnlock.volume = 0;
                audioUnlock
                    .play()
                    .then(() => audioUnlock.pause())
                    .catch(() => {});

                // Prime Speech
                window.speechSynthesis.speak(new SpeechSynthesisUtterance(""));

                splash.classList.add("fade-out");
                sessionStorage.setItem("splashDismissed", "true");
                setTimeout(() => {
                    splash.style.display = "none";
                }, 800);
            }
        </script>
    </body>
</html>
